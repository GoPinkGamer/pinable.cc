<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>äº”å­æ£‹ GOMOKU - ç§»åŠ¨ä¼˜å…ˆ</title>
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&family=Noto+Sans+SC:wght@400;500;700&display=swap" rel="stylesheet">
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.min.js"></script>
    
    <!-- Google AdSense -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3137049467355939"
     crossorigin="anonymous"></script>
    
    <!-- Theme CSS -->
    <link rel="stylesheet" href="gomoku_theme.css">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }
        
        body {
            font-family: var(--font-sans) !important;
            background: var(--background) !important;
            color: var(--foreground) !important;
            min-height: 100vh;
            overflow-x: hidden;
            touch-action: manipulation;
        }
        
        .container {
            max-width: 600px;
            margin: 0 auto;
            padding: var(--spacing-md);
            display: flex;
            flex-direction: column;
            gap: var(--spacing-lg);
            min-height: 100vh;
        }
        
        /* æ ‡é¢˜åŒº */
        .header {
            text-align: center;
            padding: var(--spacing-lg) 0;
            background: var(--card);
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-md);
            border: 2px solid var(--primary);
        }
        
        .header h1 {
            font-size: 2rem !important;
            font-weight: 700 !important;
            color: var(--primary) !important;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
            letter-spacing: 2px;
        }
        
        .header .subtitle {
            font-size: 0.875rem;
            color: var(--muted-foreground);
            margin-top: var(--spacing-xs);
        }
        
        /* ç©å®¶ä¿¡æ¯æ  */
        .player-info {
            background: var(--card);
            border-radius: var(--radius-lg);
            padding: var(--spacing-md);
            box-shadow: var(--shadow-md);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .player {
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
            transition: all var(--transition-base);
        }
        
        .player.active {
            transform: scale(1.1);
        }
        
        .player-stone {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            transition: all var(--transition-base);
        }
        
        .player-stone.black {
            background: var(--stone-black);
            box-shadow: var(--shadow-stone-black);
        }
        
        .player-stone.white {
            background: var(--stone-white);
            box-shadow: var(--shadow-stone-white);
        }
        
        .player.active .player-stone {
            animation: pulse 1s ease-in-out infinite;
        }
        
        .player-name {
            font-weight: 600;
            font-size: 1rem;
        }
        
        .game-stats {
            text-align: center;
            color: var(--muted-foreground);
            font-size: 0.875rem;
        }
        
        .game-stats .moves {
            font-weight: 600;
            color: var(--accent);
        }
        
        /* æ£‹ç›˜å®¹å™¨ */
        .board-container {
            background: var(--card);
            border-radius: var(--radius-lg);
            padding: var(--spacing-md);
            box-shadow: var(--shadow-lg);
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        .board-wrapper {
            position: relative;
            width: 100%;
            max-width: 450px;
            aspect-ratio: 1;
        }
        
        .board {
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, var(--board-light) 0%, var(--board-dark) 100%);
            border-radius: var(--radius-md);
            box-shadow: var(--shadow-board);
            position: relative;
            display: grid;
            grid-template-columns: repeat(15, 1fr);
            grid-template-rows: repeat(15, 1fr);
            gap: 0;
            padding: 4%;
            animation: boardFadeIn 0.8s ease-out;
        }
        
        .board-lines {
            position: absolute;
            top: 4%;
            left: 4%;
            right: 4%;
            bottom: 4%;
            pointer-events: none;
        }
        
        .board-line {
            position: absolute;
            background: var(--board-line);
        }
        
        .board-line.horizontal {
            height: 1.5px;
            left: 0;
            right: 0;
        }
        
        .board-line.vertical {
            width: 1.5px;
            top: 0;
            bottom: 0;
        }
        
        /* æ˜Ÿä½ */
        .star-point {
            position: absolute;
            width: 6px;
            height: 6px;
            background: var(--board-star);
            border-radius: 50%;
            transform: translate(-50%, -50%);
        }
        
        /* äº¤å‰ç‚¹ */
        .intersection {
            position: relative;
            cursor: pointer;
            display: flex;
            justify-content: center;
            align-items: center;
            touch-action: none;
        }
        
        .intersection:hover::before {
            content: '';
            position: absolute;
            width: 70%;
            height: 70%;
            border-radius: 50%;
            background: currentColor;
            opacity: 0.3;
            animation: hoverPulse 0.3s ease-out;
        }
        
        .intersection.black:hover::before {
            color: var(--stone-black);
        }
        
        .intersection.white:hover::before {
            color: var(--stone-white);
        }
        
        /* æ£‹å­ */
        .stone {
            width: 85%;
            height: 85%;
            border-radius: 50%;
            position: absolute;
            animation: stoneDrop 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            z-index: var(--z-base);
        }
        
        .stone.black {
            background: radial-gradient(circle at 30% 30%, #333, var(--stone-black));
            box-shadow: var(--shadow-stone-black);
        }
        
        .stone.white {
            background: radial-gradient(circle at 30% 30%, #fff, #e8e8e8);
            box-shadow: var(--shadow-stone-white);
        }
        
        .stone.last-move::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 30%;
            height: 30%;
            border-radius: 50%;
            background: var(--accent);
            animation: lastMovePulse 1s ease-in-out infinite;
        }
        
        .stone.winning {
            animation: winningStone 1.5s ease-in-out infinite;
            z-index: calc(var(--z-base) + 1);
        }
        
        /* è§¦æ‘¸åé¦ˆ */
        .touch-ripple {
            position: absolute;
            border-radius: 50%;
            background: var(--accent);
            opacity: 0.5;
            pointer-events: none;
            animation: ripple 0.6s ease-out;
        }
        
        /* æ§åˆ¶æŒ‰é’® */
        .controls {
            display: flex;
            gap: var(--spacing-sm);
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .btn {
            min-width: var(--touch-target);
            min-height: var(--touch-target);
            padding: var(--spacing-sm) var(--spacing-lg);
            border: none;
            border-radius: var(--radius-md);
            font-family: var(--font-sans);
            font-size: 0.875rem;
            font-weight: 600;
            cursor: pointer;
            transition: all var(--transition-fast);
            display: flex;
            align-items: center;
            gap: var(--spacing-xs);
            justify-content: center;
            box-shadow: var(--shadow-sm);
            touch-action: manipulation;
        }
        
        .btn:active {
            transform: scale(0.95);
        }
        
        .btn-primary {
            background: var(--primary);
            color: var(--primary-foreground);
        }
        
        .btn-primary:hover {
            background: var(--primary-dark);
            box-shadow: var(--shadow-md);
        }
        
        .btn-secondary {
            background: var(--secondary);
            color: var(--secondary-foreground);
        }
        
        .btn-secondary:hover {
            background: var(--muted);
            box-shadow: var(--shadow-md);
        }
        
        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        /* æç¤ºä¿¡æ¯ */
        .info-box {
            background: var(--muted);
            border-radius: var(--radius-md);
            padding: var(--spacing-md);
            text-align: center;
            color: var(--muted-foreground);
            font-size: 0.875rem;
            line-height: 1.6;
            box-shadow: var(--shadow-sm);
        }
        
        .info-box strong {
            color: var(--accent);
        }
        
        /* å¹¿å‘Šæ ·å¼ */
        .ad-container {
            background: var(--card);
            border-radius: var(--radius-md);
            padding: var(--spacing-sm);
            box-shadow: var(--shadow-sm);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100px;
            margin: var(--spacing-md) 0;
        }
        
        .ad-label {
            font-size: 0.75rem;
            color: var(--muted-foreground);
            text-align: center;
            margin-bottom: var(--spacing-xs);
            opacity: 0.7;
        }
        
        /* æ¸¸æˆç»“æŸå¼¹çª— */
        .modal-backdrop {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(8px);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: var(--z-modal-backdrop);
            animation: fadeIn 0.3s ease-out;
        }
        
        .modal-backdrop.show {
            display: flex;
        }
        
        .modal {
            background: var(--card);
            border-radius: var(--radius-xl);
            padding: var(--spacing-2xl);
            max-width: 90%;
            width: 400px;
            box-shadow: var(--shadow-2xl);
            text-align: center;
            animation: modalSlideIn 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            border: 2px solid var(--accent);
        }
        
        .modal-icon {
            width: 80px;
            height: 80px;
            margin: 0 auto var(--spacing-lg);
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 3rem;
            animation: celebrate 1s ease-in-out infinite;
        }
        
        .modal-icon.winner {
            background: linear-gradient(135deg, var(--accent), var(--primary));
        }
        
        .modal-icon.draw {
            background: var(--muted);
        }
        
        .modal h2 {
            font-size: 1.75rem !important;
            font-weight: 700 !important;
            color: var(--accent) !important;
            margin-bottom: var(--spacing-md);
        }
        
        .modal p {
            color: var(--muted-foreground);
            margin-bottom: var(--spacing-xl);
            font-size: 1rem;
        }
        
        /* åŠ¨ç”»å®šä¹‰ */
        @keyframes boardFadeIn {
            from {
                opacity: 0;
                transform: scale(0.9);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }
        
        @keyframes stoneDrop {
            0% {
                transform: translateY(-50px) scale(0);
                opacity: 0;
            }
            60% {
                transform: translateY(0) scale(1.1);
            }
            100% {
                transform: translateY(0) scale(1);
                opacity: 1;
            }
        }
        
        @keyframes pulse {
            0%, 100% {
                transform: scale(1);
                opacity: 1;
            }
            50% {
                transform: scale(1.15);
                opacity: 0.8;
            }
        }
        
        @keyframes hoverPulse {
            from {
                transform: scale(0);
                opacity: 0;
            }
            to {
                transform: scale(1);
                opacity: 0.3;
            }
        }
        
        @keyframes lastMovePulse {
            0%, 100% {
                opacity: 0.3;
                transform: translate(-50%, -50%) scale(1);
            }
            50% {
                opacity: 0.8;
                transform: translate(-50%, -50%) scale(1.2);
            }
        }
        
        @keyframes winningStone {
            0%, 100% {
                transform: scale(1);
                filter: drop-shadow(0 0 0 var(--accent));
            }
            50% {
                transform: scale(1.15);
                filter: drop-shadow(0 0 15px var(--accent));
            }
        }
        
        @keyframes ripple {
            from {
                width: 0;
                height: 0;
                opacity: 0.5;
            }
            to {
                width: 100px;
                height: 100px;
                opacity: 0;
            }
        }
        
        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }
        
        @keyframes modalSlideIn {
            from {
                transform: scale(0.5) translateY(-50px);
                opacity: 0;
            }
            to {
                transform: scale(1) translateY(0);
                opacity: 1;
            }
        }
        
        @keyframes celebrate {
            0%, 100% {
                transform: rotate(-5deg);
            }
            50% {
                transform: rotate(5deg);
            }
        }
        
        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 480px) {
            .container {
                padding: var(--spacing-sm);
                gap: var(--spacing-md);
            }
            
            .header h1 {
                font-size: 1.5rem !important;
            }
            
            .player-name {
                font-size: 0.875rem;
            }
            
            .player-stone {
                width: 24px;
                height: 24px;
            }
            
            .board {
                padding: 3%;
            }
            
            .btn {
                padding: var(--spacing-xs) var(--spacing-md);
                font-size: 0.75rem;
            }
        }
        
        @media (min-width: 768px) {
            .intersection:hover {
                background: rgba(255, 215, 0, 0.1);
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- æ ‡é¢˜åŒº -->
        <div class="header">
            <h1>äº”å­æ£‹ GOMOKU</h1>
            <div class="subtitle">äº”å­è¿ç ï¼Œæ™ºè€…ä¸ºç‹</div>
        </div>
        
        <!-- é¡¶éƒ¨æ¨ªå¹…å¹¿å‘Š -->
        <div class="ad-container">
            <div style="width: 100%; max-width: 728px;">
                <div class="ad-label">å¹¿å‘Š</div>
                <ins class="adsbygoogle"
                     style="display:block"
                     data-ad-client="ca-pub-3137049467355939"
                     data-ad-slot="4769400852"
                     data-ad-format="auto"
                     data-full-width-responsive="true"></ins>
            </div>
        </div>
        
        <!-- ç©å®¶ä¿¡æ¯æ  -->
        <div class="player-info">
            <div class="player active" id="blackPlayer">
                <div class="player-stone black"></div>
                <div class="player-name">é»‘æ–¹</div>
            </div>
            
            <div class="game-stats">
                <div>æ­¥æ•°: <span class="moves" id="moveCount">0</span></div>
            </div>
            
            <div class="player" id="whitePlayer">
                <div class="player-stone white"></div>
                <div class="player-name">ç™½æ–¹</div>
            </div>
        </div>
        
        <!-- æ£‹ç›˜ -->
        <div class="board-container">
            <div class="board-wrapper">
                <div class="board" id="board">
                    <div class="board-lines" id="boardLines"></div>
                </div>
            </div>
        </div>
        
        <!-- æ§åˆ¶æŒ‰é’® -->
        <div class="controls">
            <button class="btn btn-primary" id="restartBtn">
                <i data-lucide="refresh-cw"></i>
                é‡æ–°å¼€å§‹
            </button>
            <button class="btn btn-secondary" id="undoBtn" disabled>
                <i data-lucide="undo"></i>
                æ‚”æ£‹
            </button>
            <button class="btn btn-secondary" id="settingsBtn">
                <i data-lucide="settings"></i>
                è®¾ç½®
            </button>
        </div>
        
        <!-- æç¤ºä¿¡æ¯ -->
        <div class="info-box">
            <strong>æ¸¸æˆè§„åˆ™ï¼š</strong> é»‘æ–¹å…ˆè¡Œï¼Œäº”å­è¿ç ï¼ˆæ¨ªã€ç«–ã€æ–œï¼‰å³å¯è·èƒœã€‚ç‚¹å‡»æ£‹ç›˜äº¤å‰ç‚¹è½å­ã€‚
        </div>
        
        <!-- åº•éƒ¨å¹¿å‘Š -->
        <div class="ad-container">
            <div style="width: 100%; max-width: 728px;">
                <div class="ad-label">å¹¿å‘Š</div>
                <ins class="adsbygoogle"
                     style="display:block"
                     data-ad-client="ca-pub-3137049467355939"
                     data-ad-slot="4769400852"
                     data-ad-format="auto"
                     data-full-width-responsive="true"></ins>
            </div>
        </div>
    </div>
    
    <!-- æ¸¸æˆç»“æŸå¼¹çª— -->
    <div class="modal-backdrop" id="gameOverModal">
        <div class="modal">
            <div class="modal-icon winner" id="modalIcon">ğŸ†</div>
            <h2 id="modalTitle">é»‘æ–¹è·èƒœï¼</h2>
            <p id="modalMessage">æ­å–œï¼ç»è¿‡ 15 æ­¥ç²¾å½©å¯¹å¼ˆï¼Œé»‘æ–¹å–å¾—èƒœåˆ©ï¼</p>
            <button class="btn btn-primary" id="playAgainBtn">
                <i data-lucide="play"></i>
                å†æ¥ä¸€å±€
            </button>
        </div>
    </div>
    
    <script>
        // æ¸¸æˆçŠ¶æ€
        const BOARD_SIZE = 15;
        let board = Array(BOARD_SIZE).fill(null).map(() => Array(BOARD_SIZE).fill(0));
        let currentPlayer = 1; // 1: é»‘æ–¹, 2: ç™½æ–¹
        let moveCount = 0;
        let gameOver = false;
        let moveHistory = [];
        
        // åˆå§‹åŒ–æ£‹ç›˜
        function initBoard() {
            const boardElement = document.getElementById('board');
            const linesElement = document.getElementById('boardLines');
            
            // æ¸…ç©ºæ£‹ç›˜
            boardElement.innerHTML = '';
            linesElement.innerHTML = '';
            
            // ç»˜åˆ¶æ£‹ç›˜çº¿
            for (let i = 0; i < BOARD_SIZE; i++) {
                const hLine = document.createElement('div');
                hLine.className = 'board-line horizontal';
                hLine.style.top = `${(i / (BOARD_SIZE - 1)) * 100}%`;
                linesElement.appendChild(hLine);
                
                const vLine = document.createElement('div');
                vLine.className = 'board-line vertical';
                vLine.style.left = `${(i / (BOARD_SIZE - 1)) * 100}%`;
                linesElement.appendChild(vLine);
            }
            
            // æ·»åŠ æ˜Ÿä½
            const starPositions = [
                [3, 3], [3, 11], [7, 7], [11, 3], [11, 11]
            ];
            starPositions.forEach(([row, col]) => {
                const star = document.createElement('div');
                star.className = 'star-point';
                star.style.top = `${(row / (BOARD_SIZE - 1)) * 100}%`;
                star.style.left = `${(col / (BOARD_SIZE - 1)) * 100}%`;
                linesElement.appendChild(star);
            });
            
            // åˆ›å»ºäº¤å‰ç‚¹
            for (let row = 0; row < BOARD_SIZE; row++) {
                for (let col = 0; col < BOARD_SIZE; col++) {
                    const intersection = document.createElement('div');
                    intersection.className = 'intersection';
                    intersection.dataset.row = row;
                    intersection.dataset.col = col;
                    intersection.addEventListener('click', handleMove);
                    boardElement.appendChild(intersection);
                }
            }
            
            boardElement.appendChild(linesElement);
        }
        
        // å¤„ç†è½å­
        function handleMove(e) {
            if (gameOver) return;
            
            const row = parseInt(e.currentTarget.dataset.row);
            const col = parseInt(e.currentTarget.dataset.col);
            
            if (board[row][col] !== 0) return;
            
            // è§¦æ‘¸åé¦ˆ
            createRipple(e);
            
            // æ”¾ç½®æ£‹å­
            board[row][col] = currentPlayer;
            moveHistory.push({ row, col, player: currentPlayer });
            
            const stone = document.createElement('div');
            stone.className = `stone ${currentPlayer === 1 ? 'black' : 'white'} last-move`;
            e.currentTarget.appendChild(stone);
            
            // ç§»é™¤ä¹‹å‰çš„æœ€åè½å­æ ‡è®°
            document.querySelectorAll('.stone.last-move').forEach(s => {
                if (s !== stone) s.classList.remove('last-move');
            });
            
            // æ›´æ–°æ­¥æ•°
            moveCount++;
            document.getElementById('moveCount').textContent = moveCount;
            
            // æ£€æŸ¥èƒœåˆ©
            if (checkWin(row, col)) {
                endGame(currentPlayer);
                return;
            }
            
            // æ£€æŸ¥å¹³å±€
            if (moveCount === BOARD_SIZE * BOARD_SIZE) {
                endGame(0);
                return;
            }
            
            // åˆ‡æ¢ç©å®¶
            currentPlayer = currentPlayer === 1 ? 2 : 1;
            updatePlayerUI();
            
            // å¯ç”¨æ‚”æ£‹æŒ‰é’®
            document.getElementById('undoBtn').disabled = false;
        }
        
        // åˆ›å»ºè§¦æ‘¸åé¦ˆ
        function createRipple(e) {
            const ripple = document.createElement('div');
            ripple.className = 'touch-ripple';
            
            const rect = e.currentTarget.getBoundingClientRect();
            ripple.style.left = '50%';
            ripple.style.top = '50%';
            ripple.style.transform = 'translate(-50%, -50%)';
            
            e.currentTarget.appendChild(ripple);
            
            setTimeout(() => ripple.remove(), 600);
        }
        
        // æ›´æ–°ç©å®¶UI
        function updatePlayerUI() {
            const blackPlayer = document.getElementById('blackPlayer');
            const whitePlayer = document.getElementById('whitePlayer');
            
            if (currentPlayer === 1) {
                blackPlayer.classList.add('active');
                whitePlayer.classList.remove('active');
            } else {
                blackPlayer.classList.remove('active');
                whitePlayer.classList.add('active');
            }
        }
        
        // æ£€æŸ¥èƒœåˆ©
        function checkWin(row, col) {
            const directions = [
                [[0, 1], [0, -1]],   // æ¨ª
                [[1, 0], [-1, 0]],   // ç«–
                [[1, 1], [-1, -1]],  // æ–œ \
                [[1, -1], [-1, 1]]   // æ–œ /
            ];
            
            for (const [dir1, dir2] of directions) {
                let count = 1;
                const winningStones = [[row, col]];
                
                // æ­£æ–¹å‘
                for (let i = 1; i < 5; i++) {
                    const newRow = row + dir1[0] * i;
                    const newCol = col + dir1[1] * i;
                    if (newRow < 0 || newRow >= BOARD_SIZE || newCol < 0 || newCol >= BOARD_SIZE) break;
                    if (board[newRow][newCol] !== currentPlayer) break;
                    count++;
                    winningStones.push([newRow, newCol]);
                }
                
                // åæ–¹å‘
                for (let i = 1; i < 5; i++) {
                    const newRow = row + dir2[0] * i;
                    const newCol = col + dir2[1] * i;
                    if (newRow < 0 || newRow >= BOARD_SIZE || newCol < 0 || newCol >= BOARD_SIZE) break;
                    if (board[newRow][newCol] !== currentPlayer) break;
                    count++;
                    winningStones.push([newRow, newCol]);
                }
                
                if (count >= 5) {
                    highlightWinningStones(winningStones);
                    return true;
                }
            }
            
            return false;
        }
        
        // é«˜äº®è·èƒœæ£‹å­
        function highlightWinningStones(stones) {
            stones.forEach(([row, col]) => {
                const intersection = document.querySelector(`[data-row="${row}"][data-col="${col}"]`);
                const stone = intersection.querySelector('.stone');
                if (stone) {
                    stone.classList.add('winning');
                }
            });
        }
        
        // ç»“æŸæ¸¸æˆ
        function endGame(winner) {
            gameOver = true;
            
            const modal = document.getElementById('gameOverModal');
            const modalIcon = document.getElementById('modalIcon');
            const modalTitle = document.getElementById('modalTitle');
            const modalMessage = document.getElementById('modalMessage');
            
            if (winner === 0) {
                modalIcon.textContent = 'ğŸ¤';
                modalIcon.className = 'modal-icon draw';
                modalTitle.textContent = 'å¹³å±€ï¼';
                modalMessage.textContent = 'æ£‹ç›˜å·²æ»¡ï¼ŒåŒæ–¹åŠ¿å‡åŠ›æ•Œï¼';
            } else {
                modalIcon.textContent = 'ğŸ†';
                modalIcon.className = 'modal-icon winner';
                modalTitle.textContent = `${winner === 1 ? 'é»‘æ–¹' : 'ç™½æ–¹'}è·èƒœï¼`;
                modalMessage.textContent = `æ­å–œï¼ç»è¿‡ ${moveCount} æ­¥ç²¾å½©å¯¹å¼ˆï¼Œ${winner === 1 ? 'é»‘æ–¹' : 'ç™½æ–¹'}å–å¾—èƒœåˆ©ï¼`;
            }
            
            modal.classList.add('show');
        }
        
        // é‡æ–°å¼€å§‹
        function restartGame() {
            board = Array(BOARD_SIZE).fill(null).map(() => Array(BOARD_SIZE).fill(0));
            currentPlayer = 1;
            moveCount = 0;
            gameOver = false;
            moveHistory = [];
            
            document.getElementById('moveCount').textContent = '0';
            document.getElementById('undoBtn').disabled = true;
            document.getElementById('gameOverModal').classList.remove('show');
            
            initBoard();
            updatePlayerUI();
        }
        
        // æ‚”æ£‹
        function undoMove() {
            if (moveHistory.length === 0 || gameOver) return;
            
            const lastMove = moveHistory.pop();
            board[lastMove.row][lastMove.col] = 0;
            
            const intersection = document.querySelector(`[data-row="${lastMove.row}"][data-col="${lastMove.col}"]`);
            const stone = intersection.querySelector('.stone');
            if (stone) {
                stone.style.animation = 'stoneDrop 0.3s ease-in reverse';
                setTimeout(() => stone.remove(), 300);
            }
            
            moveCount--;
            document.getElementById('moveCount').textContent = moveCount;
            
            currentPlayer = lastMove.player;
            updatePlayerUI();
            
            if (moveHistory.length === 0) {
                document.getElementById('undoBtn').disabled = true;
            }
        }
        
        // äº‹ä»¶ç›‘å¬
        document.getElementById('restartBtn').addEventListener('click', restartGame);
        document.getElementById('undoBtn').addEventListener('click', undoMove);
        document.getElementById('playAgainBtn').addEventListener('click', restartGame);
        document.getElementById('settingsBtn').addEventListener('click', () => {
            alert('è®¾ç½®åŠŸèƒ½å¼€å‘ä¸­...\n\næœªæ¥å°†æ”¯æŒï¼š\n- éŸ³æ•ˆå¼€å…³\n- AIå¯¹æˆ˜\n- éš¾åº¦é€‰æ‹©\n- ä¸»é¢˜åˆ‡æ¢');
        });
        
        // åˆå§‹åŒ–
        lucide.createIcons();
        initBoard();
        updatePlayerUI();
        
        // åˆå§‹åŒ–å¹¿å‘Š
        (adsbygoogle = window.adsbygoogle || []).push({});
        (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
</body>
</html>